/**
 * Image Store - store functions
 *
 * @file store.js
 * @package Image Store
 * @author Hafid Trujillo
 * @copyright 20010-2013
 * @filesource  wp-content/plugins/image-store/_js/store.js
 * @since 3.2.1
 */
jQuery(document).ready(function(e){var t=[];var n=false;e.fn.clear_cart_form=function(){return this.each(function(){var t=this.type,n=this.tagName.toLowerCase();if(n=="form")return e(":input",this).clear_cart_form();if(t=="password"||n=="textarea")this.value="";else if(t=="text")this.value=1;else if(t=="checkbox"||t=="radio")this.checked=false;else if(n=="select")this.selectedIndex=-1})};var r=function(){$form=e("#ims-pricelist");if($form.is(":visible")){$form.hide().appendTo("body");$form.find(".ims-message").remove()}$slide=e("#"+n);$image=$slide.find(".touch-shadow");if(!$image.is(":visible")){$image.show();$slide.find(".img-metadata").show();e(document).unbind("touch_before_close touch_previous touch_next")}};try{e("#ims-pricelist").hide();if(typeof imstore=="undefined")imstore={};e(".ims-cart-form input[type=hidden]").each(function(){t[e(this).attr("name")]=e(this).attr("data-value-ims");e(this).removeAttr("data-value-ims")});e(".ims-cart-form input[type=submit]:not([name=ims-apply-changes])").bind("click",function(){fname=e(this).attr("name");if(fname!="fname")e(".ims-cart-form").attr({method:"post"});for(var n in t)e("input[name='"+n+"']").val(t[n]);if(t["_xmvdata"]>0)e(".ims-cart-form").attr({action:decodeURIComponent(e(this).attr("data-submit-url"))});else e(this).attr({name:"ims-enotification"})});e(".ims-cart-form input[name=ims-apply-changes]").bind("click",function(){e("input[name=_wpnonce]").val(t["_wpnonce"]);e(".ims-cart-form").attr({method:"post"})})}catch(i){return false}if(jQuery().imstouch){if(e(".add-images-to-cart a")[0]){e(".add-images-to-cart a").imstouch({href:"#ims-pricelist",onOpen:function(){e(".ims-message").hide();count=e(".ims-innerbox input:checked").length;e(".ims-image-count em").html(count);e("#ims-to-cart-ids").val(img_ids_to_string());if(count==0)e(".ims-add-error").show()},onClose:function(){e(".ims-add-error").hide()}})}if(e(".add-images-to-cart-single a")[0]){e(".add-images-to-cart-single a").imstouch({href:"#ims-pricelist",onOpen:function(){if(e("#ims-thumbs li.selected")[0])$ids=e("#ims-thumbs li.selected").attr("data-id");else $ids=e('.img-metadata input[name="imgs[]"]').val();e(".ims-message").hide();e("#ims-to-cart-ids").val($ids)}})}}e(document).bind("touch_open",function(){e("#ims-pricelist").clear_cart_form();e("#touch-slider .ims-slide").unbind("click")});e("body").delegate('input[name="ims-apply-changes"]',"click",function(t){t.preventDefault();e(this).bind("click",function(){return false});$form=e(".ims-cart-form");e(this).after('<span class="loading"></span>');e.post(document.location,$form.serialize()+"&ims-apply-changes=1",function(t){if($posted=e(t).find(".ims-cart-form"))document.location.reload(true)})});e("body").delegate(".ims-delete [type='checkbox']","click",function(t){$row=e(this).parents(".ims-clear-row");if(e(this).is(":checked")){$row.addClass("ims-checked")}else $row.removeClass("ims-checked")});e("body").delegate('input[name="ims-add-to-cart"]',"click",function(t){t.preventDefault();$form=e("#ims-pricelist");$form.find(".ims-message").remove();$submitdiv=e("#ims-pricelist .ims-submit").addClass("loading");e.post(document.location,$form.serialize()+"&ims-add-to-cart=1",function(t){e(".ims-innerbox label.ims-selected").removeClass("ims-selected");e(".ims-innerbox [type='checkbox']").removeAttr("checked");$submitdiv.removeClass("loading");$text=e(t).find("#ims-mainbox .ims-message");e("li.ims-menu-shopping-cart").replaceWith(e(t).find("li.ims-menu-shopping-cart"));if(!$text.html()&&e("body.single-ims_image")[0])window.location.reload(true);else if($text.html()=="")$form.find(".touch-close").trigger("click");else $submitdiv.prepend($text)})});e("body").delegate(".box-add-to-cart","click",function(){$form=e("#ims-pricelist").clear_cart_form();e(".ims-image-count em").html(1);$form.find(".ims-message").remove();n=e(this).parents(".ims-slide").attr("id");$form.find(".touch-close").unbind("click").bind("click",function(){$slide=e("#"+n);$slide.find(".touch-shadow").show();$slide.find(".img-metadata").show();e("#ims-pricelist").hide().appendTo("body")});$form.bind("touchstart",function(e){var t=e.originalEvent,n=t.changedTouches[0].pageX;$form.bind("touchmove",function(e){t=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0];if(Math.abs(t.pageX-n)>5)return false;$form.unbind("touchmove")})});$slide=e("#"+n);$slide.find(".touch-shadow").hide();$slide.find(".img-metadata").hide();e("#ims-to-cart-ids").val(e(this).attr("id"));$slide.append($form.css({display:"inline-block"}));e(document).bind("touch_before_close touch_previous touch_next",r);return false});active=e(".ims-login-tags").attr("data-active");e(".ims-form:visible").hide();e("#ims-"+active+"-form").show();e(".form-tab-"+active).addClass("active");e(".ims-login-tags li").click(function(){e(".ims-form:visible").hide();e(".ims-login-tags li.active").removeClass("active");e(this).addClass("active");e(".ims-form").eq(e(".ims-login-tags li").index(e(this))).show();return false});e("#touch-overlay").delegate("label:has('input')","mousedown",function(){imgid=e(this).find('input[type="checkbox"]').val();$checkbox=e('.ims-gallery input[value="'+imgid+'"]');if(e(this).hasClass("ims-selected")){$checkbox.removeAttr("checked");e(this).removeClass("ims-selected");$checkbox.parent().removeClass("ims-selected")}else{e(this).addClass("ims-selected");$checkbox.attr({checked:"checked"});$checkbox.parent().addClass("ims-selected")}})})